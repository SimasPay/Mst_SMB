-- Script to remove unused transaction types, system parameters and permissions
delete from role_permission where role not in (select enumcode from role);

Delete from system_parameters where ParameterName IN ('fac.prefix.value', 'maximum.value.of.cashout.at.atm', 'nibss.inter.emoney.transfer.code',
 'allowed.partners.toregister.throughapi', 'partner.register.throughapi.approvalrequired', 'category.postpaid', 'category.prepaid');
 
 delete from service_transaction where transactiontypeid in (select id from transaction_type where TransactionName IN ('CashIn', 'SubscriberRegistration', 'AgentActivation', 'AgentToAgentTransfer','SendReceipt','FundReimburse', 'ReverseTransaction', 'CashOutToUnRegistered', 'BulkTransfer', 'SubBulkTransfer', 'SettleBulkTransfer', 'TellerEMoneyClearance', 'ReverseCharge', 'CashOutAtATM', 'BillInquiry', 'Adjustments', 'FundAllocation', 'FundWithdrawal', 'Refund', 'FundReversal', 'InterEmoneyTransfer', 'SubscriberRegistrationThroughWeb', 'PartnerRegistrationThroughAPI', 'AirtimePinPurchase', 'NFCCardUnlink', 'NFCPocketBalance', 'NFCCardTopup', 'NFCCardTopupReversal', 'CashOut', 'ChargeSettlement', 'TransferToUnregistered', 'TransferToSystem', 'TransferToTreasury', 'ChangeEmail', 'ChangeNickname', 'ForgotPin'));

delete from rule_key where transactiontypeid  in (select id from transaction_type where TransactionName IN ('CashIn', 'SubscriberRegistration', 'AgentActivation', 'AgentToAgentTransfer','SendReceipt','FundReimburse', 'ReverseTransaction', 'CashOutToUnRegistered', 'BulkTransfer', 'SubBulkTransfer', 'SettleBulkTransfer', 'TellerEMoneyClearance', 'ReverseCharge', 'CashOutAtATM', 'BillInquiry', 'Adjustments', 'FundAllocation', 'FundWithdrawal', 'Refund', 'FundReversal', 'InterEmoneyTransfer', 'SubscriberRegistrationThroughWeb', 'PartnerRegistrationThroughAPI', 'AirtimePinPurchase', 'NFCCardUnlink', 'NFCPocketBalance', 'NFCCardTopup', 'NFCCardTopupReversal', 'CashOut', 'ChargeSettlement', 'TransferToUnregistered', 'TransferToSystem', 'TransferToTreasury', 'ChangeEmail', 'ChangeNickname', 'ForgotPin'));

Delete from transaction_type where TransactionName IN ('CashIn', 'SubscriberRegistration', 'AgentActivation', 'AgentToAgentTransfer','SendReceipt','FundReimburse', 'ReverseTransaction', 'CashOutToUnRegistered', 'BulkTransfer', 'SubBulkTransfer', 'SettleBulkTransfer', 'TellerEMoneyClearance', 'ReverseCharge', 'CashOutAtATM', 'BillInquiry', 'Adjustments', 'FundAllocation', 'FundWithdrawal', 'Refund', 'FundReversal', 'InterEmoneyTransfer', 'SubscriberRegistrationThroughWeb', 'PartnerRegistrationThroughAPI', 'AirtimePinPurchase', 'NFCCardUnlink', 'NFCPocketBalance', 'NFCCardTopup', 'NFCCardTopupReversal', 'CashOut', 'ChargeSettlement', 'TransferToUnregistered', 'TransferToSystem', 'TransferToTreasury', 'ChangeEmail', 'ChangeNickname', 'ForgotPin');

delete from role_permission where permission in (select permission from permission_item where ItemID IN ('olap', 'bulktransfer', 'bulktransfer.approve', 'bulktransfer.cancel', 'bulktransfer.verify', 'bulktransfer.upload', 'enumPage', 'enum.grid.add', 'enum.grid.edit', 'servicepartner.details.distribute', 'teller', 'teller.sub.pocket.add', 'fundDefinitions', 'fundDefinitions.add', 'fundDefinitions.edit', 'purpose.add', 'expiry.add', 'transactionMonitor', 'actorChannelMapping', 'actorChannelMapping.add', 'actorChannelMapping.edit', 'adjustments', 'adjustments.apply', 'adjustments.approve', 'sub.settle.closed.account', 'sub.settle.closed.account.approve.reject', 'pinprompt', 'trans.button', 'sub.form.mobileno', 'sub.balance.emptyButton', 'sub.details.checkBalance', 'chargeTransaction.resendAccessCode', 'chargeTransaction.reverse', 'chargeTransaction.approve', 'notification.grid.add', 'subscriber.cashin', 'subscriber.cashout', 'partner.transfer', 'systemParameters.add', 'brand', 'brand.grid.add', 'distributionHierarchy', 'dct.distribute.amount'));

Delete from permission_item where ItemID IN ('olap', 'bulktransfer', 'bulktransfer.approve', 'bulktransfer.cancel', 'bulktransfer.verify', 'bulktransfer.upload', 'enumPage', 'enum.grid.add', 'enum.grid.edit', 'servicepartner.details.distribute', 'teller', 'teller.sub.pocket.add', 'fundDefinitions', 'fundDefinitions.add', 'fundDefinitions.edit', 'purpose.add', 'expiry.add', 'transactionMonitor', 'actorChannelMapping', 'actorChannelMapping.add', 'actorChannelMapping.edit', 'adjustments', 'adjustments.apply', 'adjustments.approve', 'sub.settle.closed.account', 'sub.settle.closed.account.approve.reject', 'pinprompt', 'trans.button', 'sub.form.mobileno', 'sub.balance.emptyButton', 'sub.details.checkBalance', 'chargeTransaction.resendAccessCode', 'chargeTransaction.reverse', 'chargeTransaction.approve', 'notification.grid.add', 'subscriber.cashin', 'subscriber.cashout', 'partner.transfer', 'systemParameters.add', 'brand', 'brand.grid.add', 'distributionHierarchy', 'dct.distribute.amount');

Delete from permission_group where PermissionGroupName IN ('Analytics', 'Bank Teller', 'Enum Page', 'MNO Params', 'Bulk Transfer', 'Fund Definitions', 'Transaction Monitor',  'Actor Channel Mapping', 'Adjustments', 'Funding For Agent', 'Distribution Hierarchy');

update permission_item set permissiongroupid = 14 where permission in (12501,12502,12503,12504,12505,12506,12507,12508);
