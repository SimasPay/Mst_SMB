{
    "ReportName" : "TransactionExcelReport",
    
    "ReportHeaderText" : "Transaction Excel Report",
                            
    "ReportHeader" : [   
                           [ "Date Range From" , "${StartTime}", "To" , "${EndTime}" ],
                           [ "Reference ID" , "${ReferenceNo}"],
                           [ "Transaction Type" , "${TransactionType}"],
                           [ "Bank RRN" , "${BankRRN}"],
                           [ "Source MDN" , "${SourceMDN}"],
                           [ "Destination MDN" , "${DestinationMDN}"],
                           [ "Source Partner Code" , "${SourcePartnerCode}"],
                           [ "Dest Partner Code" , "${DestPartnerCode}"],
   						   [ "Biller Code" , "${BillerCode}"],   	
                           [ "Channel Name", "${ChannelName}"]
                     ],
    
    "ReportHeaderDataColumnsWidth" : [ 2,2,1,2],
         
    "HeaderColumns" : [ "Reference ID", 
    					"Transaction Type", 
    					"Transaction Amount", 
    					"Charge From Source", 
    					"Charge Mode",
    					"Status", 
    					"Status Reason", 
    					"Transaction Time",
    					"SourceMDN",
    					"DestinationMDN",
    					"Additional Info",
    					"Biller Info ",
    					"Integration RRN", 
    					"Channel Name",
    					"Service Name",   					
    					"Invoice No ",  
    					"Integration Type",
    					"Description",
    					"Operator Response",
    					"ReconciliationID1",
    					"ReconciliationID2",
    					"ReconciliationID3"
    					],
    
    "HeaderColumnsWidth" : [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],

    "EncryptedColumnIndices" : [],
        
    "Query" : " SELECT 
					sctl.ID,
					tt.transactionname,
					sctl.TransactionAmount,
					round(sctl.CalculatedCharge, 2),
					et4.DisplayText,
					et1.DisplayText,
					sctl.failurereason,
					TO_CHAR (FROM_TZ(CAST(sctl.CreateTime AS TIMESTAMP),'+00:00') AT TIME ZONE '$(TimeZone)',  'DD-MM-YYYY HH24:MI:SS'),
					sctl.SourceMDN,
					sctl.DestMDN,
					sctl.Info1,
					sctl.MFSBillerCode,
					ct.BankRetrievalReferenceNumber,
					channel.CHANNELNAME,
					service.SERVICENAME,
					sctl.InvoiceNo,
					isSummary.IntegrationType,
					sctl.Description,
					ct.OperatorResponseCode,
					isSummary.ReconcilationID1,
					isSummary.ReconcilationID2,
					isSummary.ReconcilationID3
				FROM 
					enum_text et1,
					service_charge_txn_log sctl
					LEFT OUTER JOIN commodity_transfer ct on ct.TRANSACTIONID = sctl.TRANSACTIONID
					INNER JOIN channel_code channel ON channel.ID = sctl.ChannelCodeID
					INNER JOIN service service ON service.ID = sctl.ServiceID
					LEFT OUTER JOIN integration_summary isSummary ON  sctl.ID = isSummary.SctlId
					JOIN transaction_type tt on tt.ID=sctl.transactionTypeId
					LEFT OUTER JOIN interbank_transfers ibt on ibt.sctlid = sctl.id
					LEFT OUTER JOIN enum_text et4 on (sctl.chargemode = et4.EnumCode OR sctl.chargemode is null)
				WHERE 
					sctl.TransactionTypeID= tt.ID
					AND et1.TagID=6089 AND sctl.status=et1.EnumCode
					AND et4.TagID=6116 
					AND sctl.CreateTime >=${StartTime}
					AND sctl.CreateTime <= ${EndTime}
					AND (sctl.MFSBILLERCODE like ${BillerCode})
					AND sctl.TransactionTypeID like ${TransactionType}
					AND sctl.id like ${ReferenceNo}
					AND sctl.status like ${TransactionStatus}
					 AND sctl.SourceMDN like ${SourceMDN} 
					 AND sctl.DestMDN like ${DestinationMDN}
				Order by sctl.id;",
    
    "ReportFooter" : [ 
                           [ "Report Generation Date" , "${ReportGenerationDate}", "Generated By" , "${UserName}" ]
                          ],
    
    "ReportFooterDataColumnsWidth" : [ 2,2,1,2],
        
    "PageSize" : "A1",

    "PageOrientation" : "landscape"
    
}