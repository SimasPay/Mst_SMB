{
    "ReportName" : "BIReport",
    
    "ReportHeaderText" : "BI Report",
                            
    "ReportHeader" : [ 
                           [ "Date Range From" , "${StartTime}", "To" , "${EndTime}" ]
                          ],
    
    "ReportHeaderDataColumnsWidth" : [ 5,3,1,6 ],
         
    "HeaderColumns" : [ "Sandi Jenis Informasi",
    					"Jumlah"
						],
    
    "HeaderColumnsWidth" : [2,2],

    "EncryptedColumnIndices" : [12],
        
    "Query" : "		SELECT
    				
    				'Jumlah Total Kartu',(SELECT  count(*) FROM subscriber_mdn sm	WHERE sm.Status = 1 AND sm.CreateTime < ${EndTime}),
    				'Jumlah Kartu Baru',(SELECT  count(*) FROM subscriber_mdn sm	WHERE sm.Status = 1 AND sm.CreateTime < ${EndTime} 
    				AND sm.CreateTime >= ${StartTime}),
					'Jumlah Kartu yang Ditutup',(SELECT  count(*)	FROM subscriber_mdn sm	WHERE sm.Status = 3 AND sm.CreateTime < ${EndTime}
			     	AND sm.CreateTime >= ${StartTime}),
			     	'Jumlah Registered',(SELECT  count(*) FROM subscriber s WHERE s.KYCLevel = 3 AND s.CreateTime < ${EndTime}
			     	AND s.CreateTime >= ${StartTime}),
					'Jumlah Unregistered',(SELECT  count(*) FROM subscriber s WHERE s.KYCLevel = 1 AND s.CreateTime < ${EndTime}
			     	AND s.CreateTime >= ${StartTime}),
			     	'Nominal Dana Float',(SELECT CurrentBalance from pocket where ID IN 
			     	(select ParameterValue from system_parameters where ParameterName='global.sva.pocket.id')),
			     	
			     	'Volume Transaksi belanja domestik (interchange)',(select count(*) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName IN 
			     	('Purchase','BillPay','AirtimePurchase','AirtimePinPurchase','NFCCardTopup','NFCPocketTopup','QRPayment')) 
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime} AND sctl.Status = 4),
			     	
			     	'Volume Transfer antar uang elektronik',(select count(*) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName IN 
			     	('Transfer','AgentToAgentTransfer','InterBankTransfer','InterEmoneyTransfer')) 
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime} AND sctl.Status = 4),
			     	
			     	'Volume Initial (Isi pertama kali)',(select count(*) from cashin_first_time cft where cft.CreateTime < ${EndTime} AND cft.CreateTime >= ${StartTime}),
			     	
			     	'Volume Reload/Top up',   (select count(*) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName like '%cashin%') 
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime}  AND sctl.Status = 4) - (select count(*) from cashin_first_time cft where cft.CreateTime < ${EndTime} AND cft.CreateTime >= ${StartTime}) ,
			     	
			     	'Volume Tarik tunai ',(select count(*) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName like '%cashout%')
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime} AND sctl.Status = 4),
			     	
			     	'Volume Reedem',(select count(*) from money_clearance_graved mcg where mcg.MCStatus=1 
			     	AND mcg.CreateTime < ${EndTime} AND mcg.CreateTime >= ${StartTime}),
			     	
			     				     	'Nominal Transaksi belanja domestik (interchange)',(select FORMAT(COALESCE(SUM(sctl.TransactionAmount),0),2) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName IN 
			     	('Purchase','BillPay','AirtimePurchase','AirtimePinPurchase','NFCCardTopup','NFCPocketTopup','QRPayment')) 
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime} AND sctl.Status = 4),
			     	
			     	'Nominal Transfer antar uang elektronik',(select FORMAT(COALESCE(SUM(sctl.TransactionAmount),0),2) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName IN 
			     	('Transfer','AgentToAgentTransfer','InterBankTransfer','InterEmoneyTransfer')) 
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime} AND sctl.Status = 4),
			     	
			     	'Nominal Initial (Isi pertama kali)',(select FORMAT(COALESCE(SUM(cft.TransactionAmount),0),2) from cashin_first_time cft where  cft.CreateTime < ${EndTime} AND cft.CreateTime >= ${StartTime}),
			     	
			     	'Nominal Reload/Top up',  (FORMAT((select COALESCE(SUM(sctl.TransactionAmount),0) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName like '%cashin%') 
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime} AND sctl.Status = 4) -  (select COALESCE(SUM(cft.TransactionAmount),0) from cashin_first_time cft where  cft.CreateTime < ${EndTime} AND cft.CreateTime >= ${StartTime}),2))  ,
			     	
			     	'Nominal Tarik tunai',(select FORMAT(COALESCE(SUM(sctl.TransactionAmount),0),2) from service_charge_txn_log sctl where sctl.TransactionTypeID IN 
			     	(select ID from transaction_type tt where tt.TransactionName like '%cashout%')
			     	AND sctl.CreateTime < ${EndTime} AND sctl.CreateTime >= ${StartTime} AND sctl.Status = 4),
			     	
			     	'Nominal Reedem',(select FORMAT(COALESCE(SUM(mcg.Amount),0),2) from money_clearance_graved mcg where mcg.MCStatus=1 
			     	AND mcg.CreateTime < ${EndTime} AND mcg.CreateTime >= ${StartTime})
			     	
			     	
			     	
					FROM
					DUAL ",
				     
					  
	
    
    "ReportFooter" : [ 
                           [ "Report Generation Date" , "${ReportGenerationDate}", "Generated By" , "${UserName}" ]
                          ],
    
    "ReportFooterDataColumnsWidth" : [ 2,1,1,2 ],
        
    "PageSize" : "A4",

    "PageOrientation" : "portrait"
    
}