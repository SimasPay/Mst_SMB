{
    "ReportName" : "AMLReport",
    
    "ReportHeaderText" : "AML Report",
                            
    "ReportHeader" : [ 
                           [ "Date Range From" , "${StartTime}", "To" , "${EndTime}" ],
                           [ "ID Card No", "${IDCardNo}"]
                          ],
    
    "ReportHeaderDataColumnsWidth" : [ 5,3,1,6 ],
         
    "HeaderColumns" : [ "KTP ID", 
    					"MDNs Used",
    					"Current Month Total",
    					"Previous Month Total",
    					"Suspect 1",
    					"Suspect 2"
						],
    
    "HeaderColumnsWidth" : [2,2,3,3,2,2],

    "EncryptedColumnIndices" : [],
        
    "Query" : "	SELECT 
					sm.IDNumber, 
					count(distinct(sm.MDN)), 
					@currentTotal := round(sum(sctl.TransactionAmount),2),
					@previousTotal := ( SELECT 
											round(sum(sctl2.TransactionAmount),2)
										FROM 
											subscriber_mdn sm2, 
											service_charge_txn_log sctl2, 
											transaction_type tt2
										WHERE 
											sctl2.SourceMDN = sm2.MDN 
											AND sctl2.TransactionTypeID = tt2.ID
											AND tt2.TransactionName IN ('Transfer','TransferToUnRegistered')
											AND sctl2.status IN (2,3,4,6,7,8,9,10,11,12,13,14,15)
											AND month(sctl2.createtime + INTERVAL 1 MONTH) = month( sctl.createtime)
											AND year(sctl2.createtime + INTERVAL 1 MONTH) = year( sctl.createtime)
											AND sm2.IDNumber = sm.IDNumber ),

					CASE
						WHEN @currentTotal >= 100000000 THEN 'true'
						ELSE 'false'
					END,
					CASE
						WHEN ( @currentTotal >= 50000000 AND @previousTotal < 50000000) THEN 'true'
						ELSE 'false'
					END
				FROM 
					subscriber_mdn sm, service_charge_txn_log sctl, transaction_type tt
				WHERE 
					sctl.SourceMDN = sm.MDN 
					AND sctl.TransactionTypeID = tt.ID
					AND tt.TransactionName IN ('Transfer','TransferToUnRegistered')
					AND sctl.status IN (2,3,4,6,7,8,9,10,11,12,13,14,15)
					AND sctl.CreateTime < ${EndTime}
			     	AND sctl.CreateTime >= ${StartTime}
			     	AND sm.IDNumber like  ${IDCardNo}
				GROUP BY 
					sm.IDNumber ",
    
    "ReportFooter" : [ 
                           [ "Report Generation Date" , "${ReportGenerationDate}", "Generated By" , "${UserName}" ]
                          ],
    
    "ReportFooterDataColumnsWidth" : [ 2,1,1,2 ],
        
    "PageSize" : "A4",

    "PageOrientation" : "portrait"
    
}